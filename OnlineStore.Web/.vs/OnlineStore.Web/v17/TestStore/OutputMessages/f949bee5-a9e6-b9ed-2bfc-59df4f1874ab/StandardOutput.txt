info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (168ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
      CREATE DATABASE [OnlineStoreTestDB];
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (35ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
      IF SERVERPROPERTY('EngineEdition') <> 5
      BEGIN
          ALTER DATABASE [OnlineStoreTestDB] SET READ_COMMITTED_SNAPSHOT ON;
      END;
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT 1
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE TABLE [Categories] (
          [CategoryId] int NOT NULL IDENTITY,
          [Name] nvarchar(50) NOT NULL,
          CONSTRAINT [PK_Categories] PRIMARY KEY ([CategoryId])
      );
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE TABLE [Orders] (
          [OrderId] int NOT NULL IDENTITY,
          [CustomerName] nvarchar(max) NOT NULL,
          [OrderDate] datetime2 NOT NULL,
          CONSTRAINT [PK_Orders] PRIMARY KEY ([OrderId])
      );
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE TABLE [Products] (
          [ProductId] int NOT NULL IDENTITY,
          [Name] nvarchar(max) NOT NULL,
          [Price] decimal(18,2) NOT NULL,
          [CategoryId] int NOT NULL,
          CONSTRAINT [PK_Products] PRIMARY KEY ([ProductId]),
          CONSTRAINT [FK_Products_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([CategoryId]) ON DELETE CASCADE
      );
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE TABLE [OrderProducts] (
          [OrderId] int NOT NULL,
          [ProductId] int NOT NULL,
          [Quantity] int NOT NULL,
          CONSTRAINT [PK_OrderProducts] PRIMARY KEY ([OrderId], [ProductId]),
          CONSTRAINT [FK_OrderProducts_Orders_OrderId] FOREIGN KEY ([OrderId]) REFERENCES [Orders] ([OrderId]) ON DELETE CASCADE,
          CONSTRAINT [FK_OrderProducts_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([ProductId]) ON DELETE CASCADE
      );
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE TABLE [ProductDetails] (
          [ProductDetailId] int NOT NULL IDENTITY,
          [Description] nvarchar(max) NOT NULL,
          [Specifications] nvarchar(max) NOT NULL,
          [ProductId] int NOT NULL,
          CONSTRAINT [PK_ProductDetails] PRIMARY KEY ([ProductDetailId]),
          CONSTRAINT [FK_ProductDetails_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([ProductId]) ON DELETE CASCADE
      );
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE INDEX [IX_OrderProducts_ProductId] ON [OrderProducts] ([ProductId]);
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE UNIQUE INDEX [IX_ProductDetails_ProductId] ON [ProductDetails] ([ProductId]);
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE INDEX [IX_Products_CategoryId] ON [Products] ([CategoryId]);
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 50), @p1='?' (Size = 50), @p2='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
      SET IMPLICIT_TRANSACTIONS OFF;
      SET NOCOUNT ON;
      MERGE [Categories] USING (
      VALUES (@p0, 0),
      (@p1, 1),
      (@p2, 2)) AS i ([Name], _Position) ON 1=0
      WHEN NOT MATCHED THEN
      INSERT ([Name])
      VALUES (i.[Name])
      OUTPUT INSERTED.[CategoryId], i._Position;
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (Size = 4000), @p8='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='Text', CommandTimeout='30']
      SET IMPLICIT_TRANSACTIONS OFF;
      SET NOCOUNT ON;
      MERGE [Products] USING (
      VALUES (@p0, @p1, @p2, 0),
      (@p3, @p4, @p5, 1),
      (@p6, @p7, @p8, 2)) AS i ([CategoryId], [Name], [Price], _Position) ON 1=0
      WHEN NOT MATCHED THEN
      INSERT ([CategoryId], [Name], [Price])
      VALUES (i.[CategoryId], i.[Name], i.[Price])
      OUTPUT INSERTED.[ProductId], i._Position;
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
      SET IMPLICIT_TRANSACTIONS OFF;
      SET NOCOUNT ON;
      MERGE [Orders] USING (
      VALUES (@p0, @p1, 0),
      (@p2, @p3, 1),
      (@p4, @p5, 2)) AS i ([CustomerName], [OrderDate], _Position) ON 1=0
      WHEN NOT MATCHED THEN
      INSERT ([CustomerName], [OrderDate])
      VALUES (i.[CustomerName], i.[OrderDate])
      OUTPUT INSERTED.[OrderId], i._Position;
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
      SET IMPLICIT_TRANSACTIONS OFF;
      SET NOCOUNT ON;
      INSERT INTO [OrderProducts] ([OrderId], [ProductId], [Quantity])
      VALUES (@p0, @p1, @p2),
      (@p3, @p4, @p5),
      (@p6, @p7, @p8),
      (@p9, @p10, @p11);
Given baza danych zawiera 3 kategorie, 3 produkty i 3 zamówienia
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT COUNT(*)
      FROM [Categories] AS [c]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT COUNT(*)
      FROM [Products] AS [p]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT COUNT(*)
      FROM [Orders] AS [o]
-> done: DatabaseSteps.GivenDatabaseHasInitialData() (0.0s)
Given użytkownik otwiera stronę "Products"
warn: Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware[3]
      Failed to determine the https port for redirect.
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT [p].[ProductId], [p].[CategoryId], [p].[Name], [p].[Price], [c].[CategoryId], [c].[Name]
      FROM [Products] AS [p]
      INNER JOIN [Categories] AS [c] ON [p].[CategoryId] = [c].[CategoryId]
-> done: NavigationSteps.OpenPage("Products") (0.0s)
When użytkownik klika przycisk "Create New"
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT [c].[CategoryId], [c].[Name]
      FROM [Categories] AS [c]
-> done: ButtonsSteps.WhenUserClicksGlobalButton("Create New") (0.0s)
And użytkownik wpisuje w polu "Name" wartość "Product 2"
-> done: InsertSteps.WhenUserInsertsValueInField("Name", "Product 2") (0.0s)
And użytkownik wpisuje w polu "Price" wartość "-1"
-> done: InsertSteps.WhenUserInsertsValueInField("Price", "-1") (0.0s)
And użytkownik wpisuje w polu "CategoryId" wartość "2"
-> done: InsertSteps.WhenUserInsertsValueInField("CategoryId", "2") (0.0s)
And użytkownik wpisuje w polu "Description" wartość "Opis produktu 2"
-> done: InsertSteps.WhenUserInsertsValueInField("Description", "Opis produktu 2") (0.0s)
And użytkownik wpisuje w polu "Specifications" wartość "Specyfikacja produktu 2"
-> done: InsertSteps.WhenUserInsertsValueInField("Specifications", "Specyfikacja prod...") (0.0s)
And użytkownik klika przycisk "Create"
[Name, Product 2]
[Price, -1]
[CategoryId, 2]
[ProductDetail.Description, Opis produktu 2]
[ProductDetail.Specifications, Specyfikacja produktu 2]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT [c].[CategoryId], [c].[Name]
      FROM [Categories] AS [c]
-> done: ButtonsSteps.WhenUserClicksGlobalButton("Create") (0.0s)
Then użytkownik powinien zobaczyć komunikat o błędzie "Price must be greater than zero."
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create - OnlineStore</title>
    <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/site.css?v=pAGv4ietcJNk_EwsQZ5BN9-K4MuNYS2a9wl4Jw-q9D0" />
    <link rel="stylesheet" href="/OnlineStore.Web.styles.css" />
</head>
<body>
    <header b-owlhy5b8ao>
        <nav b-owlhy5b8ao class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
            <div b-owlhy5b8ao class="container-fluid">
                <a class="navbar-brand" href="/">OnlineStore</a>
                <button b-owlhy5b8ao class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span b-owlhy5b8ao class="navbar-toggler-icon"></span>
                </button>
                <div b-owlhy5b8ao class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
                    <ul b-owlhy5b8ao class="navbar-nav flex-grow-1">
                        <li b-owlhy5b8ao class="nav-item">
                            <a class="nav-link text-dark" href="/Categories">Categories</a>
                        </li>
                        <li b-owlhy5b8ao class="nav-item">
                            <a class="nav-link text-dark" href="/Products">Products</a>
                        </li>
                        <li b-owlhy5b8ao class="nav-item">
                            <a class="nav-link text-dark" href="/Orders">Orders</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <div b-owlhy5b8ao class="container">
        <main b-owlhy5b8ao role="main" class="pb-3">
            

<h1>Create Product</h1>

<hr />
<div class="row">
    <div class="col-md-6">
        <form method="post" action="/Products/Create">
            
            

            <!-- Product Fields -->
            <div class="form-group">
                <label for="Name">Name</label>
                <input class="form-control" type="text" data-val="true" data-val-required="Name is required." id="Name" name="Name" value="Product 2" />
                <span class="text-danger field-validation-valid" data-valmsg-for="Name" data-valmsg-replace="true"></span>
            </div>

            <div class="form-group">
                <label class="control-label" for="Price">Price</label>
                <input class="form-control input-validation-error" type="text" data-val="true" data-val-number="The field Price must be a number." data-val-range="Price must be greater than zero." data-val-range-max="1.7976931348623157E&#x2B;308" data-val-range-min="0.01" data-val-required="Price is required." id="Price" name="Price" value="-1" />
                <span class="text-danger field-validation-error" data-valmsg-for="Price" data-valmsg-replace="true">Price must be greater than zero.</span>
            </div>

            <div class="form-group">
                <label for="CategoryId">CategoryId</label>
                <select class="form-control" data-val="true" data-val-required="Category is required." id="CategoryId" name="CategoryId"><option value="1">Category 1</option>
<option selected="selected" value="2">Category 2</option>
<option value="3">Category 3</option>
</select>
                <span class="text-danger field-validation-valid" data-valmsg-for="CategoryId" data-valmsg-replace="true"></span>
            </div>

            <!-- ProductDetail Fields -->
            <h4>Product Details</h4>
            <div class="form-group">
                <label for="ProductDetail_Description">Description</label>
                <textarea class="form-control" data-val="true" data-val-required="Description is required." id="ProductDetail_Description" name="ProductDetail.Description">
Opis produktu 2</textarea>
                <span class="text-danger field-validation-valid" data-valmsg-for="ProductDetail.Description" data-valmsg-replace="true"></span>
            </div>

            <div class="form-group">
                <label for="ProductDetail_Specifications">Specifications</label>
                <textarea class="form-control" data-val="true" data-val-required="Specifications are required." id="ProductDetail_Specifications" name="ProductDetail.Specifications">
Specyfikacja produktu 2</textarea>
                <span class="text-danger field-validation-valid" data-valmsg-for="ProductDetail.Specifications" data-valmsg-replace="true"></span>
            </div>

            <button type="submit" class="btn btn-primary">Create</button>
        <input name="__RequestVerificationToken" type="hidden" value="CfDJ8I2HPjCdLVBKudtMOtocqYqJyEA4saky0gmMZlW10f2hmFpWbJkCWXEv6KbiAuui9DQnMkBb0GuOJUbuMYIZX5BTgRkcTRCAJLrD1QEDNQ5D-usWzsAFTpTts_ngsjD_c1whbsHAB0rgg6iPVqJunC0" /></form>
    </div>
</div>

<div>
    <a href="/Products">Back to List</a>
</div>



        </main>
    </div>

    <footer b-owlhy5b8ao class="border-top footer text-muted">
        <div b-owlhy5b8ao class="container">
            &copy; 2024 - OnlineStore.Web
        </div>
    </footer>
    <script src="/lib/jquery/jquery.min.js"></script>
    <script src="/lib/jquery-validation/jquery.validate.min.js"></script>
    <script src="/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
    <script src="/js/site.js"></script>
    
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/jquery-validation/jquery.validate.min.js"></script>
<script src="/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>



</body>
</html>

-> done: NavigationSteps.ShouldSeeError("Price must be gre...") (0.0s)
And użytkownik powinien zobaczyć stronę "Products/Create"
-> done: NavigationSteps.ShouldBeOnPage("Products/Create") (0.0s)
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT 1
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
      IF SERVERPROPERTY('EngineEdition') <> 5
      BEGIN
          ALTER DATABASE [OnlineStoreTestDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
      END;
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
      DROP DATABASE [OnlineStoreTestDB];
